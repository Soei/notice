"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const u=require("@soei/util"),n=require("@soei/util/position"),s=require("vue"),c=(e,t)=>{const i=e.__vccOpts||e;for(const[r,o]of t)i[r]=o;return i},f={name:"Notice",props:{visible:{type:Boolean,default:!1},lazy:{type:[Number,String],default:1e3},start:{type:[Number,String],default:80},position:{type:String,default:"bottom"},bind:{type:Object},animate:{type:Boolean,default:!0},resize:{type:Boolean,default:!0},filter:{type:Function,default:e=>e}},data(){return{show:!1,target:null,room:this.$refs.refNotice,css:{left:0,top:0},mark:"emx-leave",M:{Escape:!0,27:!0},has:!1}},mounted(){this.esc(!0),u.runer("hasAttribute",this.room=this.$refs.refNotice,"fly")&&document.documentElement.appendChild(this.room)},unmounted(){this.esc(!1)},methods:{esc(e){try{document.documentElement[e?"addEventListener":"removeEventListener"]("keyup",this.escfx)}catch{}},escfx(e){this.M[u.picker(e,"key|code|keyCode=>k").k]&&this.leave(10)},draw:n.resize,reDraw(e){setTimeout(()=>{let t=this.room.style,i=this.room.offsetHeight,r=t.display;e&&e.offsetHeight?(i||(t.display="block"),n.position(this),i||(t.display=r)):this.$visible(!1)},+this.start)},enter(){clearTimeout(this.showmark)},leave(e){this.enter(),!(e<=-1)&&(this.showmark=setTimeout(()=>{this.$emit("update:visible",!1),this.$emit("update:bind",null)},e))},listener(e){e.hasAttribute(this.mark)||(e.setAttribute(this.mark,""),e.addEventListener("mouseleave",()=>{this.leave(this.lazy)}),e.addEventListener("mouseenter",()=>{this.enter()}))},$visible(e){setTimeout(()=>{this.has=!/^0\w*$/.test(this.room.style.top),this.has||(this.target&&n.position(this),this.has=!0),this.show=e},+this.start)}},watch:{visible(e){this.$visible(e)},bind(e,t){e&&(this.target=e),this.$visible(e&&e.offsetHeight),e&&(this.enter(),this.listener(e),this.resize&&n.observer.observe(e),this.$nextTick(()=>{this.reDraw(e)})),t&&n.observer.unobserve(t)}}},d={class:"notice-content"};function m(e,t,i,r,o,l){return s.withDirectives((s.openBlock(),s.createElementBlock("div",{ref:"refNotice",class:s.normalizeClass(["notice",{"ex-animating":o.has&&i.animate}]),style:s.normalizeStyle(i.filter(o.css)),onMouseleave:t[0]||(t[0]=a=>l.leave(i.lazy)),onMouseenter:t[1]||(t[1]=(...a)=>l.enter&&l.enter(...a)),onKeyup:t[2]||(t[2]=s.withKeys(a=>l.leave(10),["esc"]))},[s.createElementVNode("div",d,[s.renderSlot(e.$slots,"default",{},void 0,!0)]),s.createElementVNode("div",{style:s.normalizeStyle({top:"-"+o.css.top,left:"-"+o.css.left})},null,4)],38)),[[s.vShow,o.show]])}const h=c(f,[["render",m],["__scopeId","data-v-0b592e48"]]),v=[h],y={install(e){v.forEach(t=>{e.component("S"+t.name,t)})}};exports.Notice=h;exports.default=y;
